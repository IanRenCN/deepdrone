<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepDrone</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <button class="icon-btn" id="newChatBtn" title="New chat">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 5v14M5 12h14"/>
                </svg>
            </button>
            <button class="icon-btn" id="toggleSidebarBtn" title="Close sidebar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 3H3v18h18V3z"/>
                    <path d="M9 3v18"/>
                </svg>
            </button>
        </div>

        <div class="sidebar-content">
            <div class="chat-history" id="chatHistory">
                <!-- Chat history items will be added here -->
            </div>
        </div>

        <div class="sidebar-footer">
            <button class="sidebar-btn" id="settingsBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v6m0 6v6M1 12h6m6 0h6"/>
                </svg>
                <span>Settings</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Top Bar -->
        <div class="top-bar">
            <button class="icon-btn" id="openSidebarBtn" style="display: none;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12h18M3 6h18M3 18h18"/>
                </svg>
            </button>

            <div class="model-info">
                <span id="currentModel">DeepDrone</span>
                <div class="status-dot" id="statusDot"></div>
            </div>

            <button class="icon-btn" id="telemetryToggleBtn" title="Toggle telemetry">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <path d="M9 3v18"/>
                </svg>
            </button>
        </div>

        <!-- Chat Messages -->
        <div class="chat-container" id="chatContainer">
            <div class="messages" id="messages">
                <div class="welcome-screen">
                    <h1>DeepDrone</h1>
                    <p>Control your drone with natural language</p>
                    <div class="suggestion-grid">
                        <button class="suggestion-card" data-prompt="Take off to 20 meters">
                            <div class="suggestion-title">Take Off</div>
                            <div class="suggestion-text">Take off to 20 meters</div>
                        </button>
                        <button class="suggestion-card" data-prompt="What's my current altitude and battery status?">
                            <div class="suggestion-title">Check Status</div>
                            <div class="suggestion-text">Get altitude and battery</div>
                        </button>
                        <button class="suggestion-card" data-prompt="Fly in a square pattern with 30m sides">
                            <div class="suggestion-title">Square Pattern</div>
                            <div class="suggestion-text">Fly in a square pattern</div>
                        </button>
                        <button class="suggestion-card" data-prompt="Return home and land safely">
                            <div class="suggestion-title">Return Home</div>
                            <div class="suggestion-text">Return and land safely</div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Telemetry Panel -->
        <div class="telemetry-panel" id="telemetryPanel">
            <div class="telemetry-header">
                <span>Telemetry</span>
                <button class="icon-btn-small" id="closeTelemetryBtn">×</button>
            </div>
            <div class="telemetry-data">
                <div class="telem-item">
                    <span class="telem-label">Mode</span>
                    <span class="telem-value" id="telemMode">-</span>
                </div>
                <div class="telem-item">
                    <span class="telem-label">Armed</span>
                    <span class="telem-value" id="telemArmed">-</span>
                </div>
                <div class="telem-item">
                    <span class="telem-label">Altitude</span>
                    <span class="telem-value" id="telemAlt">-</span>
                </div>
                <div class="telem-item">
                    <span class="telem-label">Battery</span>
                    <span class="telem-value" id="telemBattery">-</span>
                </div>
            </div>
        </div>

        <!-- Input Area -->
        <div class="input-container">
            <div class="input-wrapper">
                <textarea
                    id="messageInput"
                    placeholder="Message DeepDrone..."
                    rows="1"
                ></textarea>
                <button class="send-btn" id="sendBtn" disabled>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 19V5M5 12l7-7 7 7"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="icon-btn" id="closeSettingsBtn">×</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>AI Configuration</h3>
                    <div class="form-group">
                        <label>Provider</label>
                        <select id="provider" class="input">
                            <option value="">Select provider...</option>
                            <option value="openai">OpenAI</option>
                            <option value="anthropic">Anthropic</option>
                            <option value="google">Google</option>
                            <option value="ollama">Ollama (Local)</option>
                        </select>
                    </div>
                    <div class="form-group" id="apiKeyGroup" style="display: none;">
                        <label>API Key</label>
                        <input type="password" id="apiKey" class="input" placeholder="Enter your API key">
                    </div>
                    <div class="form-group" id="modelGroup" style="display: none;">
                        <label>Model</label>
                        <select id="model" class="input">
                            <option value="">Select model...</option>
                        </select>
                    </div>
                    <div id="aiStatus" class="status-msg"></div>
                </div>

                <div class="settings-section">
                    <h3>Drone Connection</h3>
                    <div class="form-group">
                        <label>Connection String</label>
                        <input type="text" id="connectionString" class="input"
                               value="udp:127.0.0.1:14550" placeholder="udp:127.0.0.1:14550">
                        <small>Default: udp:127.0.0.1:14550 (simulator)</small>
                    </div>
                    <div class="drone-actions">
                        <button class="btn-secondary" id="connectBtn">Connect Drone</button>
                        <button class="btn-secondary" id="disconnectBtn" style="display: none;">Disconnect Drone</button>
                    </div>
                    <div id="droneStatus" class="status-msg"></div>
                </div>

                <div class="modal-footer">
                    <button class="save-btn" id="saveBtn" disabled title="Save settings">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="20 6 9 17 4 12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
